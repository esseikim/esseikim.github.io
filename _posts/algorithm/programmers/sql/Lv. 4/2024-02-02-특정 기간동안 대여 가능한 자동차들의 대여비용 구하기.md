---
categories: [Programmers, SQL, Oracle, Lv.4]
tags: [Programmers, SQL, Oracle, Lv.4] 
---

<https://school.programmers.co.kr/learn/courses/30/lessons/157339>{:target="_blank"}

![문제](/assets/img/programmers/sql/oracle/lv.4/%ED%8A%B9%EC%A0%95_%EA%B8%B0%EA%B0%84%EB%8F%99%EC%95%88_%EB%8C%80%EC%97%AC_%EA%B0%80%EB%8A%A5%ED%95%9C_%EC%9E%90%EB%8F%99%EC%B0%A8%EB%93%A4%EC%9D%98_%EB%8C%80%EC%97%AC%EB%B9%84%EC%9A%A9_%EA%B5%AC%ED%95%98%EA%B8%B0(1).png)
![문제](/assets/img/programmers/sql/oracle/lv.4/%ED%8A%B9%EC%A0%95_%EA%B8%B0%EA%B0%84%EB%8F%99%EC%95%88_%EB%8C%80%EC%97%AC_%EA%B0%80%EB%8A%A5%ED%95%9C_%EC%9E%90%EB%8F%99%EC%B0%A8%EB%93%A4%EC%9D%98_%EB%8C%80%EC%97%AC%EB%B9%84%EC%9A%A9_%EA%B5%AC%ED%95%98%EA%B8%B0(2).png)

- 문제 풀이

```sql
SELECT C.CAR_ID, C.CAR_TYPE, (C.DAILY_FEE * 30) * (100 - P.DISCOUNT_RATE) / 100  AS "FEE"
FROM CAR_RENTAL_COMPANY_CAR C
JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN P
ON C.CAR_TYPE = P.CAR_TYPE
WHERE 1 = 1 
AND CAR_ID NOT IN (
                  SELECT CAR_ID 
                  FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
                  WHERE END_DATE > TO_DATE(20221101, 'YYYY-MM-DD'))
AND C.CAR_TYPE IN ('세단', 'SUV')
AND P.DURATION_TYPE = '30일 이상'
AND (C.DAILY_FEE * 30) * (100 - P.DISCOUNT_RATE) / 100 >= 500000 
AND (C.DAILY_FEE * 30) * (100 - P.DISCOUNT_RATE) / 100 < 2000000
ORDER BY FEE DESC, C.CAR_TYPE, C.CAR_ID DESC;
```
```sql
SELECT CAR_ID, C.CAR_TYPE, (DAILY_FEE * 30) * (100-DISCOUNT_RATE) / 100 AS FEE
FROM CAR_RENTAL_COMPANY_CAR C
JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN P
ON C.CAR_TYPE = P.CAR_TYPE AND P.DURATION_TYPE = '30일 이상'
WHERE CAR_ID NOT IN (
    SELECT CAR_ID
    FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
    WHERE TO_CHAR(END_DATE, 'YYYY-MM-DD') > '2022-11-01'
)
AND C.CAR_TYPE IN ('세단', 'SUV')
AND (DAILY_FEE * 30) * (100-DISCOUNT_RATE) / 100 >= 500000
AND (DAILY_FEE * 30) * (100-DISCOUNT_RATE) / 100 < 2000000
ORDER BY 3 DESC, 2, 1 DESC
```
```sql
SELECT
    CAR_ID,
    C.CAR_TYPE,
    (DAILY_FEE * 30) * (100 - DISCOUNT_RATE) / 100 AS FEE
FROM
    CAR_RENTAL_COMPANY_CAR C
JOIN
    CAR_RENTAL_COMPANY_DISCOUNT_PLAN P
ON C.CAR_TYPE = P.CAR_TYPE
WHERE
    P.DURATION_TYPE = '30일 이상'
    AND CAR_ID NOT IN (
        SELECT CAR_ID
        FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
        WHERE TO_CHAR(END_DATE, 'YYYY-MM-DD') > '2022-11-01'
    )
    AND C.CAR_TYPE IN ('세단', 'SUV')
    AND (DAILY_FEE * 30) * (100 - DISCOUNT_RATE) / 100 >= 500000
    AND (DAILY_FEE * 30) * (100 - DISCOUNT_RATE) / 100 < 2000000
ORDER BY
    FEE DESC,
    C.CAR_TYPE,
    CAR_ID DESC;
```


<br>
- 오답
![실행 결과](/assets/img/programmers/sql/oracle/lv.4/%ED%8A%B9%EC%A0%95_%EA%B8%B0%EA%B0%84%EB%8F%99%EC%95%88_%EB%8C%80%EC%97%AC_%EA%B0%80%EB%8A%A5%ED%95%9C_%EC%9E%90%EB%8F%99%EC%B0%A8%EB%93%A4%EC%9D%98_%EB%8C%80%EC%97%AC%EB%B9%84%EC%9A%A9_%EA%B5%AC%ED%95%98%EA%B8%B0(3).png)

![실행 결과](/assets/img/programmers/sql/oracle/lv.4/%ED%8A%B9%EC%A0%95_%EA%B8%B0%EA%B0%84%EB%8F%99%EC%95%88_%EB%8C%80%EC%97%AC_%EA%B0%80%EB%8A%A5%ED%95%9C_%EC%9E%90%EB%8F%99%EC%B0%A8%EB%93%A4%EC%9D%98_%EB%8C%80%EC%97%AC%EB%B9%84%EC%9A%A9_%EA%B5%AC%ED%95%98%EA%B8%B0(4).png)

<br>
- 실행 결과

![실행 결과](/assets/img/programmers/sql/oracle/lv.4/%ED%8A%B9%EC%A0%95_%EA%B8%B0%EA%B0%84%EB%8F%99%EC%95%88_%EB%8C%80%EC%97%AC_%EA%B0%80%EB%8A%A5%ED%95%9C_%EC%9E%90%EB%8F%99%EC%B0%A8%EB%93%A4%EC%9D%98_%EB%8C%80%EC%97%AC%EB%B9%84%EC%9A%A9_%EA%B5%AC%ED%95%98%EA%B8%B0(5).png)
