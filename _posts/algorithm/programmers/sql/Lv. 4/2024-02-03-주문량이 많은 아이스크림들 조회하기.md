---
categories: [Programmers, SQL, Oracle, Lv.4]
tags: [Programmers, SQL, Oracle, Lv.4, UNION, JOIN] 
---

<https://school.programmers.co.kr/learn/courses/30/lessons/133027>{:target="_blank"}

![문제](/assets/img/programmers/sql/oracle/lv.4/%EC%A3%BC%EB%AC%B8%EB%9F%89%EC%9D%B4_%EB%A7%8E%EC%9D%80_%EC%95%84%EC%9D%B4%EC%8A%A4%ED%81%AC%EB%A6%BC%EB%93%A4_%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B8%B0(1).png)
![문제](/assets/img/programmers/sql/oracle/lv.4/%EC%A3%BC%EB%AC%B8%EB%9F%89%EC%9D%B4_%EB%A7%8E%EC%9D%80_%EC%95%84%EC%9D%B4%EC%8A%A4%ED%81%AC%EB%A6%BC%EB%93%A4_%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B8%B0(2).png)


- 문제 풀이

```sql
SELECT FLAVOR
FROM(
    SELECT F.FLAVOR, SUM(F.TOTAL_ORDER + J.TOTAL_ORDER) AS "SUM"
    FROM FIRST_HALF F
    JOIN JULY J
    ON F.FLAVOR = J.FLAVOR
    GROUP BY F.FLAVOR
    ORDER BY SUM DESC
    FETCH FIRST 3 ROWS ONLY
    );
```

```sql
SELECT F.FLAVOR 
FROM FIRST_HALF F, JULY J
WHERE F.FLAVOR = J.FLAVOR
GROUP BY F.FLAVOR
ORDER BY SUM(F.TOTAL_ORDER + J.TOTAL_ORDER) DESC
FETCH FIRST 3 ROWS ONLY;

SELECT F.FLAVOR
FROM FIRST_HALF F
JOIN JULY J
ON F.FLAVOR = J.FLAVOR
GROUP BY F.FLAVOR
ORDER BY SUM(F.TOTAL_ORDER + J.TOTAL_ORDER) DESC
FETCH FIRST 3 ROWS ONLY
```

![실행 결과](/assets/img/programmers/sql/oracle/lv.4/%EC%A3%BC%EB%AC%B8%EB%9F%89%EC%9D%B4_%EB%A7%8E%EC%9D%80_%EC%95%84%EC%9D%B4%EC%8A%A4%ED%81%AC%EB%A6%BC%EB%93%A4_%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B8%B0(3).png)

![실행 결과](/assets/img/programmers/sql/oracle/lv.4/%EC%A3%BC%EB%AC%B8%EB%9F%89%EC%9D%B4_%EB%A7%8E%EC%9D%80_%EC%95%84%EC%9D%B4%EC%8A%A4%ED%81%AC%EB%A6%BC%EB%93%A4_%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B8%B0(4).png)

```sql
-- 각 테이블 별 맛에 대하여 GROUP BY하고 JOIN으로 합쳐서 다시 더하여 순위를 구한다.
SELECT JULY_SUM.FLAVOR
FROM
    (
        SELECT FLAVOR, SUM(TOTAL_ORDER) SUM1
        FROM JULY
        GROUP BY FLAVOR
    ) JULY_SUM
    ,(
        SELECT FLAVOR, SUM(TOTAL_ORDER) SUM2
        FROM FIRST_HALF
        GROUP BY FLAVOR
    ) FIRST_HALF_SUM
WHERE JULY_SUM.FLAVOR = FIRST_HALF_SUM.FLAVOR
ORDER BY SUM1+SUM2 DESC
FETCH FIRST 3 ROWS ONLY;
```

```sql
SELECT FLAVOR
FROM
    (
    SELECT *
    FROM JULY
    UNION
    SELECT *
    FROM FIRST_HALF
    ) A
GROUP BY FLAVOR
ORDER BY SUM(TOTAL_ORDER) DESC
FETCH FIRST 3 ROWS ONLY;
```

![실행 결과](/assets/img/programmers/sql/oracle/lv.4/%EC%A3%BC%EB%AC%B8%EB%9F%89%EC%9D%B4_%EB%A7%8E%EC%9D%80_%EC%95%84%EC%9D%B4%EC%8A%A4%ED%81%AC%EB%A6%BC%EB%93%A4_%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B8%B0(5).png)

> - 두 테이블 모두 FLAVOR에 대한 정보를 가진다.
 - 다만, 하나의 FLAVOR라도 여러 출하번호를 가질 수 있다.
{: .prompt-info }

<br>
- 실행 결과

![실행 결과](/assets/img/programmers/sql/oracle/lv.4/%EC%A3%BC%EB%AC%B8%EB%9F%89%EC%9D%B4_%EB%A7%8E%EC%9D%80_%EC%95%84%EC%9D%B4%EC%8A%A4%ED%81%AC%EB%A6%BC%EB%93%A4_%EC%A1%B0%ED%9A%8C%ED%95%98%EA%B8%B0(6).png)
